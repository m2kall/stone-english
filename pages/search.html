<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯æ±‡æœç´¢ - Stone English</title>
    
    <!-- Favicon å›¾æ ‡é…ç½® -->
    <link rel="apple-touch-icon" sizes="180x180" href="../favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../favicon_io/favicon-16x16.png">
    <link rel="manifest" href="../favicon_io/site.webmanifest">
    <link rel="shortcut icon" href="../favicon_io/favicon.ico">
    
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/components.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <span class="logo-emoji">ğŸ“š</span>
                <span>Stone English</span>
            </div>
            <ul class="nav-menu">
                <li><a href="../index.html" class="nav-link">ğŸ  é¦–é¡µ</a></li>
                <li><a href="vocabulary.html" class="nav-link">ğŸ“š è¯æ±‡</a></li>
                <li><a href="grammar.html" class="nav-link">ğŸ“ è¯­æ³•</a></li>
                <li><a href="practice.html" class="nav-link">ğŸ¯ ç»ƒä¹ </a></li>
            </ul>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <main class="container">
        <div class="search-section">
            <h1 class="page-title">ğŸ“ è¯æ±‡æœç´¢</h1>
            
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="è¾“å…¥è¦æœç´¢çš„å•è¯..." class="search-input">
                <button id="searchBtn" class="btn btn-primary">æœç´¢</button>
            </div>

            <div class="search-filters">
                <select id="levelFilter" class="filter-select">
                    <option value="">æ‰€æœ‰çº§åˆ«</option>
                    <option value="basic">åŸºç¡€</option>
                    <option value="intermediate">ä¸­çº§</option>
                    <option value="advanced">é«˜çº§</option>
                </select>
                
                <select id="categoryFilter" class="filter-select">
                    <option value="">æ‰€æœ‰ç±»åˆ«</option>
                    <option value="common">å¸¸ç”¨è¯æ±‡</option>
                    <option value="academic">å­¦æœ¯è¯æ±‡</option>
                    <option value="business">å•†åŠ¡è¯æ±‡</option>
                </select>
            </div>
        </div>

        <div id="searchResults" class="search-results">
            <!-- æœç´¢ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
        </div>
    </main>

    <script src="../scripts/word-generator.js"></script>
    <script src="../scripts/vocabulary-manager.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            const searchBtn = document.getElementById('searchBtn');
            const levelFilter = document.getElementById('levelFilter');
            const categoryFilter = document.getElementById('categoryFilter');
            const resultsContainer = document.getElementById('searchResults');

            // æœç´¢åŠŸèƒ½
            function performSearch() {
                const searchTerm = searchInput.value.trim().toLowerCase();
                const level = levelFilter.value;
                const category = categoryFilter.value;

                if (!searchTerm) {
                    resultsContainer.innerHTML = '<p class="no-results">è¯·è¾“å…¥æœç´¢å…³é”®è¯</p>';
                    return;
                }

                // ä½¿ç”¨ vocabularyManager æœç´¢è¯æ±‡
                const results = window.vocabularyManager.searchWords(searchTerm, level, category);
                displayResults(results);
            }

            // æ˜¾ç¤ºæœç´¢ç»“æœ
            function displayResults(results) {
                if (results.length === 0) {
                    resultsContainer.innerHTML = '<p class="no-results">æœªæ‰¾åˆ°åŒ¹é…çš„è¯æ±‡</p>';
                    return;
                }

                const html = results.map(word => `
                    <div class="word-card">
                        <div class="word-header">
                            <h3 class="word-title">${word.word}</h3>
                            <button class="pronunciation-btn" onclick="pronounceWord('${word.word}')">ğŸ”Š</button>
                        </div>
                        <div class="word-phonetic">${word.phonetic || ''}</div>
                        <div class="word-meaning">${word.meaning || ''}</div>
                        <div class="word-example">${word.example || ''}</div>
                        <div class="word-actions">
                            <button class="btn btn-primary" onclick="addToReview('${word.word}')">
                                æ·»åŠ åˆ°å¤ä¹ 
                            </button>
                        </div>
                    </div>
                `).join('');

                resultsContainer.innerHTML = html;
            }

            // æ·»åŠ åˆ°å¤ä¹ åˆ—è¡¨
            window.addToReview = function(word) {
                try {
                    let reviewWords = JSON.parse(localStorage.getItem('reviewWords')) || [];
                    
                    if (reviewWords.includes(word)) {
                        showNotification('è¯¥è¯æ±‡å·²åœ¨å¤ä¹ åˆ—è¡¨ä¸­', 'info');
                        return;
                    }
                    
                    reviewWords.push(word);
                    localStorage.setItem('reviewWords', JSON.stringify(reviewWords));
                    
                    showNotification('å·²æ·»åŠ åˆ°å¤ä¹ åˆ—è¡¨', 'success');
                    
                } catch (error) {
                    console.error('Error adding word to review:', error);
                    showNotification('æ·»åŠ å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                }
            };

            // å‘éŸ³åŠŸèƒ½
            window.pronounceWord = function(word) {
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(word);
                    utterance.lang = 'en-US';
                    speechSynthesis.speak(utterance);
                }
            };

            // äº‹ä»¶ç›‘å¬
            searchBtn.addEventListener('click', performSearch);
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
            levelFilter.addEventListener('change', performSearch);
            categoryFilter.addEventListener('change', performSearch);
        });

        // é€šçŸ¥åŠŸèƒ½
        function showNotification(message, type = 'info') {
            // å®ç°é€šçŸ¥æ˜¾ç¤ºé€»è¾‘
            alert(message);
        }
    </script>
</body>
</html>