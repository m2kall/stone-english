<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯­æ³•æŒ‡å— - Stone English</title>
    <!-- Favicon å›¾æ ‡é…ç½® -->
    <link rel="apple-touch-icon" sizes="180x180" href="../favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../favicon_io/favicon-16x16.png">
    <link rel="manifest" href="../favicon_io/site.webmanifest">
    <link rel="shortcut icon" href="../favicon_io/favicon.ico">
    <meta name="msapplication-TileColor" content="#4f46e5">
    <meta name="theme-color" content="#4f46e5">
    
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/components.css">
    <style>
        .grammar-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .grammar-nav {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .grammar-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .category-btn {
            padding: 1rem;
            border: 2px solid #e1e5e9;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            text-decoration: none;
            color: #374151;
        }
        
        .category-btn:hover {
            border-color: #4f46e5;
            background: #f8fafc;
        }
        
        .category-btn.active {
            border-color: #4f46e5;
            background: #4f46e5;
            color: white;
        }
        
        .category-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            display: block;
        }
        
        .grammar-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .grammar-section {
            display: none;
        }
        
        .grammar-section.active {
            display: block;
        }
        
        .section-title {
            color: #1f2937;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e1e5e9;
        }
        
        .grammar-item {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            background: #f9fafb;
        }
        
        .grammar-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #4f46e5;
            margin-bottom: 1rem;
        }
        
        .grammar-explanation {
            color: #374151;
            line-height: 1.6;
            margin-bottom: 1rem;
        }
        
        .grammar-examples {
            background: white;
            padding: 1rem;
            border-radius: 6px;
            border-left: 4px solid #10b981;
        }
        
        .example-item {
            margin-bottom: 0.5rem;
            padding: 0.5rem 0;
        }
        
        .example-correct {
            color: #059669;
        }
        
        .example-incorrect {
            color: #dc2626;
            text-decoration: line-through;
        }
        
        .grammar-quiz {
            background: #f0f9ff;
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1rem;
        }
        
        .quiz-question {
            font-weight: bold;
            margin-bottom: 1rem;
            color: #1e40af;
        }
        
        .quiz-options {
            display: grid;
            gap: 0.5rem;
        }
        
        .quiz-option {
            padding: 0.8rem;
            border: 1px solid #e1e5e9;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .quiz-option:hover {
            background: #f3f4f6;
        }
        
        .quiz-option.correct {
            background: #d1fae5;
            border-color: #10b981;
        }
        
        .quiz-option.incorrect {
            background: #fee2e2;
            border-color: #ef4444;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e1e5e9;
            border-radius: 4px;
            margin: 1rem 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: #4f46e5;
            transition: width 0.3s;
        }
        
        .search-grammar {
            margin-bottom: 1rem;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #4f46e5;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <span class="logo-emoji">ğŸ“š</span>
                <span>Stone English</span>
            </div>
            <ul class="nav-menu">
                <li><a href="../index.html" class="nav-link">ğŸ  é¦–é¡µ</a></li>
                <li><a href="vocabulary.html" class="nav-link">ğŸ“š è¯æ±‡</a></li>
                <li><a href="grammar.html" class="nav-link active">ğŸ“ è¯­æ³•</a></li>
                <li><a href="practice.html" class="nav-link">ğŸ¯ ç»ƒä¹ </a></li>
            </ul>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <main class="grammar-container">
        <h1 class="page-title">ğŸ“ è¯­æ³•æŒ‡å—</h1>
        
        <!-- æœç´¢ -->
        <div class="search-grammar">
            <input type="text" class="search-input" id="grammarSearch" placeholder="æœç´¢è¯­æ³•çŸ¥è¯†ç‚¹...">
        </div>

        <!-- è¯­æ³•åˆ†ç±»å¯¼èˆª -->
        <div class="grammar-nav">
            <div class="grammar-categories">
                <button class="category-btn active" data-category="tenses">
                    <span class="category-icon">â°</span>
                    æ—¶æ€
                </button>
                <button class="category-btn" data-category="articles">
                    <span class="category-icon">ğŸ“„</span>
                    å† è¯
                </button>
                <button class="category-btn" data-category="prepositions">
                    <span class="category-icon">ğŸ”—</span>
                    ä»‹è¯
                </button>
                <button class="category-btn" data-category="conditionals">
                    <span class="category-icon">â“</span>
                    æ¡ä»¶å¥
                </button>
                <button class="category-btn" data-category="passive">
                    <span class="category-icon">ğŸ”„</span>
                    è¢«åŠ¨è¯­æ€
                </button>
                <button class="category-btn" data-category="modals">
                    <span class="category-icon">ğŸ’­</span>
                    æƒ…æ€åŠ¨è¯
                </button>
            </div>
        </div>

        <!-- è¯­æ³•å†…å®¹ -->
        <div class="grammar-content">
            <!-- æ—¶æ€éƒ¨åˆ† -->
            <div class="grammar-section active" id="tenses">
                <h2 class="section-title">â° è‹±è¯­æ—¶æ€</h2>
                
                <div class="grammar-item">
                    <div class="grammar-title">ä¸€èˆ¬ç°åœ¨æ—¶ (Simple Present)</div>
                    <div class="grammar-explanation">
                        ç”¨äºæè¿°ç»å¸¸å‘ç”Ÿçš„åŠ¨ä½œã€ä¹ æƒ¯ã€çœŸç†æˆ–ç°åœ¨çš„çŠ¶æ€ã€‚
                        <br><strong>ç»“æ„ï¼š</strong> ä¸»è¯­ + åŠ¨è¯åŸå½¢/åŠ¨è¯ç¬¬ä¸‰äººç§°å•æ•°å½¢å¼
                    </div>
                    <div class="grammar-examples">
                        <div class="example-item example-correct">âœ“ I work in a bank.</div>
                        <div class="example-item example-correct">âœ“ She speaks English fluently.</div>
                        <div class="example-item example-correct">âœ“ The sun rises in the east.</div>
                    </div>
                    <div class="grammar-quiz">
                        <div class="quiz-question">é€‰æ‹©æ­£ç¡®çš„å¥å­ï¼š</div>
                        <div class="quiz-options">
                            <div class="quiz-option" onclick="selectQuizOption(this, false)">He go to school every day.</div>
                            <div class="quiz-option" onclick="selectQuizOption(this, true)">He goes to school every day.</div>
                            <div class="quiz-option" onclick="selectQuizOption(this, false)">He going to school every day.</div>
                        </div>
                    </div>
                </div>

                <div class="grammar-item">
                    <div class="grammar-title">ç°åœ¨è¿›è¡Œæ—¶ (Present Continuous)</div>
                    <div class="grammar-explanation">
                        ç”¨äºæè¿°æ­£åœ¨è¿›è¡Œçš„åŠ¨ä½œæˆ–ä¸´æ—¶çš„æƒ…å†µã€‚
                        <br><strong>ç»“æ„ï¼š</strong> ä¸»è¯­ + beåŠ¨è¯ + åŠ¨è¯-ingå½¢å¼
                    </div>
                    <div class="grammar-examples">
                        <div class="example-item example-correct">âœ“ I am reading a book now.</div>
                        <div class="example-item example-correct">âœ“ They are playing football.</div>
                        <div class="example-item example-incorrect">âœ— I am read a book now.</div>
                    </div>
                </div>

                <div class="grammar-item">
                    <div class="grammar-title">ä¸€èˆ¬è¿‡å»æ—¶ (Simple Past)</div>
                    <div class="grammar-explanation">
                        ç”¨äºæè¿°è¿‡å»å‘ç”Ÿçš„åŠ¨ä½œæˆ–çŠ¶æ€ã€‚
                        <br><strong>ç»“æ„ï¼š</strong> ä¸»è¯­ + åŠ¨è¯è¿‡å»å¼
                    </div>
                    <div class="grammar-examples">
                        <div class="example-item example-correct">âœ“ I visited Paris last year.</div>
                        <div class="example-item example-correct">âœ“ She was a teacher.</div>
                        <div class="example-item example-correct">âœ“ We went to the cinema yesterday.</div>
                    </div>
                </div>
            </div>

            <!-- å† è¯éƒ¨åˆ† -->
            <div class="grammar-section" id="articles">
                <h2 class="section-title">ğŸ“„ å† è¯çš„ä½¿ç”¨</h2>
                
                <div class="grammar-item">
                    <div class="grammar-title">å®šå† è¯ "the"</div>
                    <div class="grammar-explanation">
                        ç”¨äºç‰¹æŒ‡æŸä¸ªäººæˆ–ç‰©ï¼Œæˆ–è€…åŒæ–¹éƒ½çŸ¥é“çš„äº‹ç‰©ã€‚
                    </div>
                    <div class="grammar-examples">
                        <div class="example-item example-correct">âœ“ The book on the table is mine.</div>
                        <div class="example-item example-correct">âœ“ The sun is shining.</div>
                        <div class="example-item example-correct">âœ“ I saw the movie you recommended.</div>
                    </div>
                </div>

                <div class="grammar-item">
                    <div class="grammar-title">ä¸å®šå† è¯ "a/an"</div>
                    <div class="grammar-explanation">
                        ç”¨äºæ³›æŒ‡æŸç±»äº‹ç‰©ä¸­çš„ä¸€ä¸ªã€‚"a" ç”¨äºè¾…éŸ³éŸ³ç´ å¼€å¤´çš„è¯å‰ï¼Œ"an" ç”¨äºå…ƒéŸ³éŸ³ç´ å¼€å¤´çš„è¯å‰ã€‚
                    </div>
                    <div class="grammar-examples">
                        <div class="example-item example-correct">âœ“ I need a pen.</div>
                        <div class="example-item example-correct">âœ“ She is an engineer.</div>
                        <div class="example-item example-correct">âœ“ It's an honor to meet you.</div>
                    </div>
                </div>
            </div>

            <!-- ä»‹è¯éƒ¨åˆ† -->
            <div class="grammar-section" id="prepositions">
                <h2 class="section-title">ğŸ”— ä»‹è¯çš„ä½¿ç”¨</h2>
                
                <div class="grammar-item">
                    <div class="grammar-title">æ—¶é—´ä»‹è¯</div>
                    <div class="grammar-explanation">
                        at, on, in ç”¨äºä¸åŒçš„æ—¶é—´è¡¨è¾¾ã€‚
                    </div>
                    <div class="grammar-examples">
                        <div class="example-item example-correct">âœ“ at 3 o'clock, at night, at Christmas</div>
                        <div class="example-item example-correct">âœ“ on Monday, on July 4th, on my birthday</div>
                        <div class="example-item example-correct">âœ“ in 2023, in summer, in the morning</div>
                    </div>
                </div>

                <div class="grammar-item">
                    <div class="grammar-title">åœ°ç‚¹ä»‹è¯</div>
                    <div class="grammar-explanation">
                        at, on, in ä¹Ÿç”¨äºä¸åŒçš„åœ°ç‚¹è¡¨è¾¾ã€‚
                    </div>
                    <div class="grammar-examples">
                        <div class="example-item example-correct">âœ“ at home, at school, at the station</div>
                        <div class="example-item example-correct">âœ“ on the table, on the wall, on the first floor</div>
                        <div class="example-item example-correct">âœ“ in the room, in London, in the box</div>
                    </div>
                </div>
            </div>

            <!-- æ¡ä»¶å¥éƒ¨åˆ† -->
            <div class="grammar-section" id="conditionals">
                <h2 class="section-title">â“ æ¡ä»¶å¥</h2>
                
                <div class="grammar-item">
                    <div class="grammar-title">ç¬¬ä¸€æ¡ä»¶å¥ (First Conditional)</div>
                    <div class="grammar-explanation">
                        ç”¨äºæè¿°çœŸå®å¯èƒ½å‘ç”Ÿçš„æƒ…å†µã€‚
                        <br><strong>ç»“æ„ï¼š</strong> If + ä¸€èˆ¬ç°åœ¨æ—¶, will + åŠ¨è¯åŸå½¢
                    </div>
                    <div class="grammar-examples">
                        <div class="example-item example-correct">âœ“ If it rains, I will stay home.</div>
                        <div class="example-item example-correct">âœ“ If you study hard, you will pass the exam.</div>
                    </div>
                </div>

                <div class="grammar-item">
                    <div class="grammar-title">ç¬¬äºŒæ¡ä»¶å¥ (Second Conditional)</div>
                    <div class="grammar-explanation">
                        ç”¨äºæè¿°å‡æƒ³çš„æˆ–ä¸å¤ªå¯èƒ½å‘ç”Ÿçš„æƒ…å†µã€‚
                        <br><strong>ç»“æ„ï¼š</strong> If + ä¸€èˆ¬è¿‡å»æ—¶, would + åŠ¨è¯åŸå½¢
                    </div>
                    <div class="grammar-examples">
                        <div class="example-item example-correct">âœ“ If I won the lottery, I would travel the world.</div>
                        <div class="example-item example-correct">âœ“ If I were you, I would apologize.</div>
                    </div>
                </div>
            </div>

            <!-- è¢«åŠ¨è¯­æ€éƒ¨åˆ† -->
            <div class="grammar-section" id="passive">
                <h2 class="section-title">ğŸ”„ è¢«åŠ¨è¯­æ€</h2>
                
                <div class="grammar-item">
                    <div class="grammar-title">è¢«åŠ¨è¯­æ€çš„æ„æˆ</div>
                    <div class="grammar-explanation">
                        <strong>ç»“æ„ï¼š</strong> beåŠ¨è¯ + è¿‡å»åˆ†è¯
                        <br>ç”¨äºå¼ºè°ƒåŠ¨ä½œçš„æ‰¿å—è€…è€Œéæ‰§è¡Œè€…ã€‚
                    </div>
                    <div class="grammar-examples">
                        <div class="example-item example-correct">âœ“ The book was written by Shakespeare.</div>
                        <div class="example-item example-correct">âœ“ English is spoken all over the world.</div>
                        <div class="example-item example-correct">âœ“ The house will be built next year.</div>
                    </div>
                </div>
            </div>

            <!-- æƒ…æ€åŠ¨è¯éƒ¨åˆ† -->
            <div class="grammar-section" id="modals">
                <h2 class="section-title">ğŸ’­ æƒ…æ€åŠ¨è¯</h2>
                
                <div class="grammar-item">
                    <div class="grammar-title">can / could</div>
                    <div class="grammar-explanation">
                        è¡¨ç¤ºèƒ½åŠ›ã€å¯èƒ½æ€§æˆ–è¯·æ±‚è®¸å¯ã€‚
                    </div>
                    <div class="grammar-examples">
                        <div class="example-item example-correct">âœ“ I can swim. (èƒ½åŠ›)</div>
                        <div class="example-item example-correct">âœ“ Can I help you? (è¯·æ±‚)</div>
                        <div class="example-item example-correct">âœ“ It could rain tomorrow. (å¯èƒ½æ€§)</div>
                    </div>
                </div>

                <div class="grammar-item">
                    <div class="grammar-title">must / have to</div>
                    <div class="grammar-explanation">
                        è¡¨ç¤ºå¿…é¡»ã€ä¹‰åŠ¡æˆ–å¼ºçƒˆçš„å»ºè®®ã€‚
                    </div>
                    <div class="grammar-examples">
                        <div class="example-item example-correct">âœ“ You must wear a seatbelt.</div>
                        <div class="example-item example-correct">âœ“ I have to go to work.</div>
                        <div class="example-item example-correct">âœ“ You must be tired after the long journey.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å­¦ä¹ è¿›åº¦ -->
        <div class="progress-section" style="margin-top: 2rem;">
            <h3>å­¦ä¹ è¿›åº¦</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="grammarProgress" style="width: 0%"></div>
            </div>
            <p id="progressText">å·²å®Œæˆ 0 ä¸ªè¯­æ³•ç‚¹</p>
        </div>
    </main>

    <script>
        class GrammarPage {
            constructor() {
                this.currentCategory = 'tenses';
                this.completedTopics = new Set(JSON.parse(localStorage.getItem('completedGrammarTopics') || '[]'));
                this.init();
            }

            init() {
                this.bindEvents();
                this.updateProgress();
                this.loadSearchFunctionality();
            }

            bindEvents() {
                // åˆ†ç±»æŒ‰é’®äº‹ä»¶
                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const category = e.currentTarget.dataset.category;
                        this.switchCategory(category);
                    });
                });

                // æœç´¢åŠŸèƒ½
                document.getElementById('grammarSearch').addEventListener('input', (e) => {
                    this.searchGrammar(e.target.value);
                });
            }

            switchCategory(category) {
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[data-category="${category}"]`).classList.add('active');

                // æ›´æ–°å†…å®¹æ˜¾ç¤º
                document.querySelectorAll('.grammar-section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById(category).classList.add('active');

                this.currentCategory = category;
            }

            searchGrammar(searchTerm) {
                const sections = document.querySelectorAll('.grammar-item');
                const term = searchTerm.toLowerCase();

                sections.forEach(section => {
                    const title = section.querySelector('.grammar-title').textContent.toLowerCase();
                    const content = section.querySelector('.grammar-explanation').textContent.toLowerCase();
                    
                    if (title.includes(term) || content.includes(term)) {
                        section.style.display = 'block';
                    } else {
                        section.style.display = searchTerm ? 'none' : 'block';
                    }
                });
            }

            markTopicCompleted(topic) {
                this.completedTopics.add(topic);
                localStorage.setItem('completedGrammarTopics', JSON.stringify([...this.completedTopics]));
                this.updateProgress();
            }

            updateProgress() {
                const totalTopics = document.querySelectorAll('.grammar-item').length;
                const completedCount = this.completedTopics.size;
                const percentage = totalTopics > 0 ? (completedCount / totalTopics) * 100 : 0;

                document.getElementById('grammarProgress').style.width = `${percentage}%`;
                document.getElementById('progressText').textContent = `å·²å®Œæˆ ${completedCount} ä¸ªè¯­æ³•ç‚¹`;
            }

            loadSearchFunctionality() {
                // å®ç°å®æ—¶æœç´¢é«˜äº®
                const searchInput = document.getElementById('grammarSearch');
                searchInput.addEventListener('input', (e) => {
                    this.highlightSearchResults(e.target.value);
                });
            }

            highlightSearchResults(searchTerm) {
                // ç§»é™¤ä¹‹å‰çš„é«˜äº®
                document.querySelectorAll('.highlight').forEach(el => {
                    el.outerHTML = el.innerHTML;
                });

                if (!searchTerm) return;

                // æ·»åŠ æ–°çš„é«˜äº®
                const sections = document.querySelectorAll('.grammar-explanation, .grammar-title');
                sections.forEach(section => {
                    const text = section.innerHTML;
                    const regex = new RegExp(`(${searchTerm})`, 'gi');
                    const highlightedText = text.replace(regex, '<span class="highlight" style="background: yellow;">$1</span>');
                    section.innerHTML = highlightedText;
                });
            }
        }

        // æµ‹éªŒé€‰æ‹©å‡½æ•°
        function selectQuizOption(element, isCorrect) {
            // ç§»é™¤æ‰€æœ‰é€‰é¡¹çš„çŠ¶æ€
            element.parentNode.querySelectorAll('.quiz-option').forEach(option => {
                option.classList.remove('correct', 'incorrect');
                option.style.pointerEvents = 'none';
            });

            // æ·»åŠ æ­£ç¡®æˆ–é”™è¯¯çš„æ ·å¼
            if (isCorrect) {
                element.classList.add('correct');
            } else {
                element.classList.add('incorrect');
                // æ˜¾ç¤ºæ­£ç¡®ç­”æ¡ˆ
                element.parentNode.querySelectorAll('.quiz-option').forEach(option => {
                    if (option !== element) {
                        // è¿™é‡Œå¯ä»¥æ·»åŠ é€»è¾‘æ¥æ ‡è¯†æ­£ç¡®ç­”æ¡ˆ
                    }
                });
            }

            // æ ‡è®°è¯¥è¯­æ³•ç‚¹ä¸ºå·²å®Œæˆ
            const grammarItem = element.closest('.grammar-item');
            const title = grammarItem.querySelector('.grammar-title').textContent;
            grammarPage.markTopicCompleted(title);
        }

        // åˆå§‹åŒ–é¡µé¢
        const grammarPage = new GrammarPage();
    </script>
</body>
</html>